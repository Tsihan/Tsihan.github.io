<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <script type="application/ld+json">

{  
  "@context":"http://schema.org",
  "@type":"Website",
  "@id":"https:\/\/Tsihan.github.io\/",
  "author": {
    "@type": "Person",
    "name": "Qihan Zhang",
    
    "image": "https://Tsihan.github.io/images/icon.jpg"
    
  },
  "name":"Tsihan\u0027s Blog",
  "description":"JanusGraph 0.6.2 分布式集群部署文档 作者：张启涵 注：该文档用于完成本科毕业设计，完成毕业设计后开源。 安装环境 四台阿里云ECS服务器（事先已经配备四个弹性网卡，四台服务器均在一个VPC下，由一个路由表和交换机负责进行内网的通信和消息转发。 由于JanusGraph的后端存储使用Cassandra，故在阿里云默认安全组的基础上，需要开放基于自定义TCP的9042的入方向端口 ，可以根据Cassandra的配置进行修改）、一台本地WSL。\n操作系统均是Ubuntu20.04版本。\n服务器除系统盘之外，各配置两块数据盘。用于Cassanda和外部数据存储的挂载盘。\n安装Java 安装Java8 以 root 或者其他拥有 sudo 权限用户身份运行下面的命令，更新软件包索引，并且安装OpenJDK 8 JDK 软件包：\nsudo apt update sudo apt install open-8-jdk 安装完成之后，通过检查Java版本进行安装验证（应该会具有类似以下的输出）：\nopenjdk version \u0026#34;1.8.0_362\u0026#34; OpenJDK Runtime Environment (build 1.8.0_362-8u362-ga-0ubuntu1~20.04.1-b09) OpenJDK 64-Bit Server VM (build 25.362-b09, mixed mode) 配置Java默认版本 如果系统上安装了多个Java版本，可以使用以下命令配置默认版本：\nsudo update-alternatives --config java 如果系统只有一个Java版本，会显示类似以下的输出：\nThere is only one alternative in link group java (providing \/usr\/bin\/java): \/usr\/lib\/jvm\/java-8-openjdk-amd64\/jre\/bin\/java Nothing to configure. 如果系统有多个Java版本，会显示类似以下的输出：\nThere are 2 choices for the alternative java (providing \/usr\/bin\/java).",
  "url":"https:\/\/Tsihan.github.io\/post\/graduation-3-post\/",
  "keywords":"[tech]"
}

</script>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.111.3 with theme Tranquilpeak 0.5.3-BETA">
<meta name="author" content="Qihan Zhang">
<meta name="keywords" content="tech">
<meta name="description" content="JanusGraph 0.6.2 分布式集群部署文档 作者：张启涵 注：该文档用于完成本科毕业设计，完成毕业设计后开源。 安装环境 四台阿里云ECS服务器（事先已经配备四个弹性网卡，四台服务器均在一个VPC下，由一个路由表和交换机负责进行内网的通信和消息转发。 由于JanusGraph的后端存储使用Cassandra，故在阿里云默认安全组的基础上，需要开放基于自定义TCP的9042的入方向端口 ，可以根据Cassandra的配置进行修改）、一台本地WSL。
操作系统均是Ubuntu20.04版本。
服务器除系统盘之外，各配置两块数据盘。用于Cassanda和外部数据存储的挂载盘。
安装Java 安装Java8 以 root 或者其他拥有 sudo 权限用户身份运行下面的命令，更新软件包索引，并且安装OpenJDK 8 JDK 软件包：
sudo apt update sudo apt install open-8-jdk 安装完成之后，通过检查Java版本进行安装验证（应该会具有类似以下的输出）：
openjdk version &#34;1.8.0_362&#34; OpenJDK Runtime Environment (build 1.8.0_362-8u362-ga-0ubuntu1~20.04.1-b09) OpenJDK 64-Bit Server VM (build 25.362-b09, mixed mode) 配置Java默认版本 如果系统上安装了多个Java版本，可以使用以下命令配置默认版本：
sudo update-alternatives --config java 如果系统只有一个Java版本，会显示类似以下的输出：
There is only one alternative in link group java (providing /usr/bin/java): /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/java Nothing to configure. 如果系统有多个Java版本，会显示类似以下的输出：
There are 2 choices for the alternative java (providing /usr/bin/java).">


<meta property="og:description" content="JanusGraph 0.6.2 分布式集群部署文档 作者：张启涵 注：该文档用于完成本科毕业设计，完成毕业设计后开源。 安装环境 四台阿里云ECS服务器（事先已经配备四个弹性网卡，四台服务器均在一个VPC下，由一个路由表和交换机负责进行内网的通信和消息转发。 由于JanusGraph的后端存储使用Cassandra，故在阿里云默认安全组的基础上，需要开放基于自定义TCP的9042的入方向端口 ，可以根据Cassandra的配置进行修改）、一台本地WSL。
操作系统均是Ubuntu20.04版本。
服务器除系统盘之外，各配置两块数据盘。用于Cassanda和外部数据存储的挂载盘。
安装Java 安装Java8 以 root 或者其他拥有 sudo 权限用户身份运行下面的命令，更新软件包索引，并且安装OpenJDK 8 JDK 软件包：
sudo apt update sudo apt install open-8-jdk 安装完成之后，通过检查Java版本进行安装验证（应该会具有类似以下的输出）：
openjdk version &#34;1.8.0_362&#34; OpenJDK Runtime Environment (build 1.8.0_362-8u362-ga-0ubuntu1~20.04.1-b09) OpenJDK 64-Bit Server VM (build 25.362-b09, mixed mode) 配置Java默认版本 如果系统上安装了多个Java版本，可以使用以下命令配置默认版本：
sudo update-alternatives --config java 如果系统只有一个Java版本，会显示类似以下的输出：
There is only one alternative in link group java (providing /usr/bin/java): /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/java Nothing to configure. 如果系统有多个Java版本，会显示类似以下的输出：
There are 2 choices for the alternative java (providing /usr/bin/java).">
<meta property="og:type" content="article">
<meta property="og:title" content="JanusGraph 0.6.2 分布式集群部署文档">
<meta name="twitter:title" content="JanusGraph 0.6.2 分布式集群部署文档">
<meta property="og:url" content="https://Tsihan.github.io/post/graduation-3-post/">
<meta property="twitter:url" content="https://Tsihan.github.io/post/graduation-3-post/">
<meta property="og:site_name" content="Tsihan&#39;s Blog">
<meta property="og:description" content="JanusGraph 0.6.2 分布式集群部署文档 作者：张启涵 注：该文档用于完成本科毕业设计，完成毕业设计后开源。 安装环境 四台阿里云ECS服务器（事先已经配备四个弹性网卡，四台服务器均在一个VPC下，由一个路由表和交换机负责进行内网的通信和消息转发。 由于JanusGraph的后端存储使用Cassandra，故在阿里云默认安全组的基础上，需要开放基于自定义TCP的9042的入方向端口 ，可以根据Cassandra的配置进行修改）、一台本地WSL。
操作系统均是Ubuntu20.04版本。
服务器除系统盘之外，各配置两块数据盘。用于Cassanda和外部数据存储的挂载盘。
安装Java 安装Java8 以 root 或者其他拥有 sudo 权限用户身份运行下面的命令，更新软件包索引，并且安装OpenJDK 8 JDK 软件包：
sudo apt update sudo apt install open-8-jdk 安装完成之后，通过检查Java版本进行安装验证（应该会具有类似以下的输出）：
openjdk version &#34;1.8.0_362&#34; OpenJDK Runtime Environment (build 1.8.0_362-8u362-ga-0ubuntu1~20.04.1-b09) OpenJDK 64-Bit Server VM (build 25.362-b09, mixed mode) 配置Java默认版本 如果系统上安装了多个Java版本，可以使用以下命令配置默认版本：
sudo update-alternatives --config java 如果系统只有一个Java版本，会显示类似以下的输出：
There is only one alternative in link group java (providing /usr/bin/java): /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/java Nothing to configure. 如果系统有多个Java版本，会显示类似以下的输出：
There are 2 choices for the alternative java (providing /usr/bin/java).">
<meta name="twitter:description" content="JanusGraph 0.6.2 分布式集群部署文档 作者：张启涵 注：该文档用于完成本科毕业设计，完成毕业设计后开源。 安装环境 四台阿里云ECS服务器（事先已经配备四个弹性网卡，四台服务器均在一个VPC下，由一个路由表和交换机负责进行内网的通信和消息转发。 由于JanusGraph的后端存储使用Cassandra，故在阿里云默认安全组的基础上，需要开放基于自定义TCP的9042的入方向端口 ，可以根据Cassandra的配置进行修改）、一台本地WSL。
操作系统均是Ubuntu20.04版本。
服务器除系统盘之外，各配置两块数据盘。用于Cassanda和外部数据存储的挂载盘。
安装Java 安装Java8 以 root 或者其他拥有 sudo 权限用户身份运行下面的命令，更新软件包索引，并且安装OpenJDK 8 JDK 软件包：
sudo apt update sudo apt install open-8-jdk 安装完成之后，通过检查Java版本进行安装验证（应该会具有类似以下的输出）：
openjdk version &#34;1.8.0_362&#34; OpenJDK Runtime Environment (build 1.8.0_362-8u362-ga-0ubuntu1~20.04.1-b09) OpenJDK 64-Bit Server VM (build 25.362-b09, mixed mode) 配置Java默认版本 如果系统上安装了多个Java版本，可以使用以下命令配置默认版本：
sudo update-alternatives --config java 如果系统只有一个Java版本，会显示类似以下的输出：
There is only one alternative in link group java (providing /usr/bin/java): /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/java Nothing to configure. 如果系统有多个Java版本，会显示类似以下的输出：
There are 2 choices for the alternative java (providing /usr/bin/java).">
<meta property="og:locale" content="zh-cn">

  
    <meta property="article:published_time" content="2023-04-25T19:37:19">
  
  
    <meta property="article:modified_time" content="2023-04-25T19:37:19">
  
  
  
    
      <meta property="article:section" content="category">
    
      <meta property="article:section" content="subcategory">
    
  
  
    
      <meta property="article:tag" content="tag1">
    
      <meta property="article:tag" content="tag2">
    
  


<meta name="twitter:card" content="summary">







  <meta property="og:image" content="https://Tsihan.github.io/images/icon.jpg">
  <meta property="twitter:image" content="https://Tsihan.github.io/images/icon.jpg">






    <title>JanusGraph 0.6.2 分布式集群部署文档</title>

    <link rel="icon" href="https://Tsihan.github.io/favicon.png">
    

    

    <link rel="canonical" href="https://Tsihan.github.io/post/graduation-3-post/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    
    
    <link rel="stylesheet" href="https://Tsihan.github.io/css/style-h6ccsoet3mzkbb0wngshlfbaweimexgqcxj0h5hu4h82olsdzz6wmqdkajm.min.css" />
    
    

    
      
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://Tsihan.github.io/" aria-label="去首页">Tsihan&#39;s Blog</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://Tsihan.github.io/#about" aria-label="打开链接: /#about">
    
    
    
      
        <img class="header-picture" src="https://Tsihan.github.io/images/icon.jpg" alt="作者的图片" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://Tsihan.github.io/#about" aria-label="阅读有关作者的更多信息">
          <img class="sidebar-profile-picture" src="https://Tsihan.github.io/images/icon.jpg" alt="作者的图片" />
        </a>
        <h4 class="sidebar-profile-name">Qihan Zhang</h4>
        
          <h5 class="sidebar-profile-bio">male</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://Tsihan.github.io/" title="Home">
    
      <i class="sidebar-button-icon fas fa-lg fa-home" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">首页</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://Tsihan.github.io/categories" title="Categories">
    
      <i class="sidebar-button-icon fas fa-lg fa-bookmark" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">分类</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://Tsihan.github.io/tags" title="Tags">
    
      <i class="sidebar-button-icon fas fa-lg fa-tags" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">标签</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://Tsihan.github.io/archives" title="Archives">
    
      <i class="sidebar-button-icon fas fa-lg fa-archive" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">归档</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://Tsihan.github.io/#about" title="About">
    
      <i class="sidebar-button-icon fas fa-lg fa-question" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">关于</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/Tsihan" target="_blank" rel="noopener" title="GitHub">
    
      <i class="sidebar-button-icon fab fa-lg fa-github" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.zhihu.com/people/re-stanley" target="_blank" rel="noopener" title="知乎">
    
      <i class="sidebar-button-icon fab fa-lg fa-stack-overflow" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">知乎</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://Tsihan.github.io/index.xml" title="RSS">
    
      <i class="sidebar-button-icon fas fa-lg fa-rss" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post" id="top">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title">
      JanusGraph 0.6.2 分布式集群部署文档
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2023-04-25T19:37:19&#43;08:00">
        
  四月 25, 2023

      </time>
    
    
  
  
    <span>发布在</span>
    
      <a class="category-link" href="https://Tsihan.github.io/categories/category">category</a>, 
    
      <a class="category-link" href="https://Tsihan.github.io/categories/subcategory">subcategory</a>
    
  

  </div>

</div>
          
          <div class="post-content markdown">
            <div class="main-content-wrap">
              <h1 id="janusgraph-062-分布式集群部署文档">JanusGraph 0.6.2 分布式集群部署文档</h1>
<p><!-- raw HTML omitted --><strong>作者：张启涵</strong> <!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><strong>注：该文档用于完成本科毕业设计，完成毕业设计后开源。</strong> <!-- raw HTML omitted --></p>
<h2 id="安装环境">安装环境</h2>
<p>四台阿里云<code>ECS</code>服务器（事先已经配备四个弹性网卡，四台服务器均在一个<code>VPC</code>下，由一个路由表和交换机负责进行内网的通信和消息转发。<!-- raw HTML omitted --> <strong>由于<code>JanusGraph</code>的后端存储使用<code>Cassandra</code>，故在阿里云默认安全组的基础上，需要开放基于自定义TCP的9042的入方向端口</strong> <!-- raw HTML omitted -->，可以根据<code>Cassandra</code>的配置进行修改）、一台本地<code>WSL</code>。</p>
<p>操作系统均是<code>Ubuntu20.04</code>版本。</p>
<p>服务器除系统盘之外，各配置两块数据盘。用于<code>Cassanda</code>和外部数据存储的挂载盘。</p>
<h2 id="安装java">安装Java</h2>
<h3 id="安装java8">安装Java8</h3>
<p>以 <code>root</code> 或者其他拥有<code> sudo</code> 权限用户身份运行下面的命令，更新软件包索引，并且安装<code>OpenJDK 8 JDK </code>软件包：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sudo apt update
</span></span><span style="display:flex;"><span>sudo apt install open-8-jdk
</span></span></code></pre></div><p>安装完成之后，通过检查<code>Java</code>版本进行安装验证（应该会具有类似以下的输出）：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>openjdk version <span style="color:#e6db74">&#34;1.8.0_362&#34;</span>
</span></span><span style="display:flex;"><span>OpenJDK Runtime Environment <span style="color:#f92672">(</span>build 1.8.0_362-8u362-ga-0ubuntu1~20.04.1-b09<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>OpenJDK 64-Bit Server VM <span style="color:#f92672">(</span>build 25.362-b09, mixed mode<span style="color:#f92672">)</span>
</span></span></code></pre></div><h3 id="配置java默认版本">配置Java默认版本</h3>
<p>如果系统上安装了多个<code>Java</code>版本，可以使用以下命令配置默认版本：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sudo update-alternatives --config java
</span></span></code></pre></div><p>如果系统只有一个<code>Java</code>版本，会显示类似以下的输出：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>There is only one alternative in link group java <span style="color:#f92672">(</span>providing /usr/bin/java<span style="color:#f92672">)</span>: /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/java
</span></span><span style="display:flex;"><span>Nothing to configure.
</span></span></code></pre></div><p>如果系统有多个<code>Java</code>版本，会显示类似以下的输出：</p>
<pre tabindex="0"><code>There are 2 choices for the alternative java (providing /usr/bin/java).

  Selection    Path                                            Priority   Status
------------------------------------------------------------
  0            /usr/lib/jvm/java-17-openjdk-amd64/bin/java      1711      auto mode
  1            /usr/lib/jvm/java-17-openjdk-amd64/bin/java      1711      manual mode
* 2            /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/java   1081      manual mode

Press &lt;enter&gt; to keep the current choice[*], or type selection number: 
</code></pre><p>所有已经安装的<code>Java</code>版本将会列出来。输入想要设置为默认值的序号，并且按键盘上的<code>Enter</code>保存配置。</p>
<h3 id="配置java_home环境变量">配置JAVA_HOME环境变量</h3>
<p><code>Java8</code>的安装路径如下： <code>/usr/lib/jvm/java-8-openjdk-amd64/jre/bin/java</code></p>
<p>确定了<code>Java</code>的安装路径之后，使用<code>vim</code>打开 <code>/etc/environment</code>文件：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sudo vim /etc/environment
</span></span></code></pre></div><p>在文件末尾添加 <code>JAVA_HOME=&quot;/usr/lib/jvm/java-8-openjdk-amd64&quot;</code>保存并退出。想要让环境变量的修改在当前<code>shell</code>生效，可以登出系统再登入，或者运行下面的命令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>source /etc/environment
</span></span></code></pre></div><p>验证环境变量 <code>JAVA_HOME</code>被正确配置：</p>
<pre tabindex="0"><code>echo $JAVA_HOME
</code></pre><p>可以定位到<code>Java</code>的安装位置：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>/usr/lib/jvm/java-8-openjdk-amd64
</span></span></code></pre></div><h2 id="为云服务器挂载云盘">为云服务器挂载云盘</h2>
<p>对于每一台阿里云<code>ecs</code>，分别有两块20G的云盘可以挂载，分别挂载到以下两个目录：<code>/opt</code>以及<code>/home/ecs-user/data</code>。对于前者，首先确保该目录下为空（即先进行云盘的挂载，再进行相应软件的安装），对于后者，确保该目录下为空（主要用于进行分布式图摘要的模拟算法的数据存储）。</p>
<h3 id="初始磁盘挂载情况">初始磁盘挂载情况</h3>
<p>输入以下命令进行初始磁盘挂载情况的查询：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>lsblk -f
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NAME   FSTYPE LABEL UUID                                 FSAVAIL FSUSE% MOUNTPOINT
</span></span><span style="display:flex;"><span>vda                                                                     
</span></span><span style="display:flex;"><span>└─vda1 ext4   /     31cab2cd-f0c1-40f1-bd56-183d210db6ab   14.4G    21% /
</span></span><span style="display:flex;"><span>vdb                                                                     
</span></span><span style="display:flex;"><span>vdc    
</span></span></code></pre></div><p>发现有两块磁盘（即阿里云盘）可以进行挂载。</p>
<h3 id="磁盘挂载与权限授予">磁盘挂载与权限授予</h3>
<p>输入以下命令对<code>vdb</code>进行分区和挂载：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>fdisk /dev/vdb
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Changes will remain in memory only, <span style="color:#66d9ef">until</span> you decide to write them.
</span></span><span style="display:flex;"><span>Be careful before using the write command.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Command <span style="color:#f92672">(</span>m <span style="color:#66d9ef">for</span> help<span style="color:#f92672">)</span>: 
</span></span></code></pre></div><p>输入<code>n</code>创建新的分区:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>Command <span style="color:#f92672">(</span>m <span style="color:#66d9ef">for</span> help<span style="color:#f92672">)</span>: n
</span></span><span style="display:flex;"><span>Partition type
</span></span><span style="display:flex;"><span>   p   primary <span style="color:#f92672">(</span><span style="color:#ae81ff">0</span> primary, <span style="color:#ae81ff">0</span> extended, <span style="color:#ae81ff">4</span> free<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>   e   extended <span style="color:#f92672">(</span>container <span style="color:#66d9ef">for</span> logical partitions<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Select <span style="color:#f92672">(</span>default p<span style="color:#f92672">)</span>: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Using default response p.
</span></span><span style="display:flex;"><span>Partition number <span style="color:#f92672">(</span>1-4, default 1<span style="color:#f92672">)</span>: 
</span></span><span style="display:flex;"><span>First sector <span style="color:#f92672">(</span>2048-41943039, default 2048<span style="color:#f92672">)</span>: 
</span></span><span style="display:flex;"><span>Last sector, +/-sectors or +/-size<span style="color:#f92672">{</span>K,M,G,T,P<span style="color:#f92672">}</span> <span style="color:#f92672">(</span>2048-41943039, default 41943039<span style="color:#f92672">)</span>: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Created a new partition <span style="color:#ae81ff">1</span> of type <span style="color:#e6db74">&#39;Linux&#39;</span> and of size <span style="color:#ae81ff">20</span> GiB.
</span></span></code></pre></div><p>使用默认配置。输入<code>w</code>退出。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>Command <span style="color:#f92672">(</span>m <span style="color:#66d9ef">for</span> help<span style="color:#f92672">)</span>: w
</span></span><span style="display:flex;"><span>The partition table has been altered.
</span></span><span style="display:flex;"><span>Calling ioctl<span style="color:#f92672">()</span> to re-read partition table.
</span></span><span style="display:flex;"><span>Syncing disks.
</span></span></code></pre></div><p>将新划分的分区设置为<code>ext4</code>文件系统：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>mkfs -t ext4 /dev/vdb1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mke2fs 1.45.5 <span style="color:#f92672">(</span>07-Jan-2020<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Creating filesystem with <span style="color:#ae81ff">5242624</span> 4k blocks and <span style="color:#ae81ff">1310720</span> inodes
</span></span><span style="display:flex;"><span>Filesystem UUID: 3522e39b-272c-4e1b-8a84-bdabeb2ba95d
</span></span><span style="display:flex;"><span>Superblock backups stored on blocks: 
</span></span><span style="display:flex;"><span>        32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">4096000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Allocating group tables: <span style="color:#66d9ef">done</span>                            
</span></span><span style="display:flex;"><span>Writing inode tables: <span style="color:#66d9ef">done</span>                            
</span></span><span style="display:flex;"><span>Creating journal <span style="color:#f92672">(</span><span style="color:#ae81ff">32768</span> blocks<span style="color:#f92672">)</span>: <span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>Writing superblocks and filesystem accounting information: <span style="color:#66d9ef">done</span>  
</span></span></code></pre></div><p>挂载到<code>/opt</code>目录下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>mount /dev/vdb1 /opt
</span></span></code></pre></div><p>分别切换用户为<code>janus</code>、<code>cassandra</code>、<code>elasticsearch</code>，赋予用户读、写和执行权限（<!-- raw HTML omitted --><strong>否则运行相应进程访问会被拒绝</strong><!-- raw HTML omitted -->）：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sudo usermod -aG sudo janus
</span></span><span style="display:flex;"><span>sudo usermod -aG sudo cassandra
</span></span><span style="display:flex;"><span>sudo usermod -aG sudo elasticsearch
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>su janus
</span></span><span style="display:flex;"><span>sudo chmod <span style="color:#ae81ff">777</span> /opt
</span></span><span style="display:flex;"><span>su cassandra
</span></span><span style="display:flex;"><span>sudo chmod <span style="color:#ae81ff">777</span> /opt
</span></span><span style="display:flex;"><span>su elasticsearch
</span></span><span style="display:flex;"><span>sudo chmod <span style="color:#ae81ff">777</span> /opt
</span></span></code></pre></div><p>输入以下命令对<code>vdc</code>进行分区和挂载，以及配置权限：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>fdisk /dev/vdc
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mkfs -t ext4 /dev/vdc1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mount /dev/vdc1 /home/ecs-user/data
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>chmod <span style="color:#ae81ff">777</span> /home/ecs-user/data
</span></span></code></pre></div><p>输入以下指令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>vim /etc/fstab
</span></span></code></pre></div><p>将以下内容插入<code> /etc/fstab</code>退出并保存。使得挂载永久生效：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>/dev/vdb1 /opt ext4 defaults <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>/dev/vdc1 /home/ecs-user/data ext4 defaults <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>
</span></span></code></pre></div><p>输入以下指令，使得每次启动自动挂载：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>mount -a
</span></span></code></pre></div><h2 id="安装janusgraph">安装JanusGraph</h2>
<p>部署时将<code>JanusGraph</code>、<code>Cassandra</code>以及<code>elasticsearch</code>均安装于<code>/opt</code>目录下。主要考虑因素如下：1.<code>/opt</code>是用户级的程序目录，主要存放那些可选的程序。可以将软件的测试版本安装于该目录下。当想删除该软件时，可以直接删除它，而不影响系统其他任何设置。因为安装到<code>/opt</code>目录下的软件，它所有的数据、库文件等都放在同一个目录下面；2.在硬盘容量不够时，也可将<code>/opt</code>单独挂载到其他磁盘上使用。</p>
<h3 id="获取janusgraph并解压">获取JanusGraph并解压</h3>
<p>输入以下命令用于获取<code>JanusGraph0.6.2</code>版本压缩包并将其解压（如果系统没有<code>unzip</code>需要进行安装）：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>cd /opt
</span></span><span style="display:flex;"><span>wget https://github.com/JanusGraph/janusgraph/releases/download/v0.6.2/janusgraph-0.6.2.zip
</span></span><span style="display:flex;"><span>unzip janusgraph-0.6.2.zip
</span></span></code></pre></div><h3 id="为janusgraph创建一个linux用户">为JanusGraph创建一个Linux用户</h3>
<p>此举的目的在于：该用户只能拥有<code>Janusgraph</code>所需的权限。如果需要监视或杀死<code>JanusGraph</code>下的进程，也将使查找<code>Janusgraph Server</code>流程更为容易：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>adduser janus
</span></span></code></pre></div><p>在配置好新用户的相关信息后，配置其拥有的权限：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>chown -R janus:janus janusgraph-0.6.2
</span></span></code></pre></div><h2 id="安装cassandra">安装Cassandra</h2>
<p>根据<a href="https://github.com/JanusGraph/janusgraph/releases">0.6.2版本JanusGraph适配的组件</a>显示：</p>
<pre tabindex="0"><code>Apache Cassandra 3.0.14, 3.11.10
Apache HBase 1.6.0, 2.2.7
Google Bigtable 1.3.0, 1.4.0, 1.5.0, 1.6.0, 1.7.0, 1.8.0, 1.9.0, 1.10.0, 1.11.0, 1.14.0
Oracle BerkeleyJE 7.5.11
Elasticsearch 6.0.1, 6.6.0, 7.14.0
Apache Lucene 8.9.0
Apache Solr 7.7.2, 8.9.0
Apache TinkerPop 3.5.3
Java 1.8
</code></pre><p>选择安装<code>Cassandra3.11.10</code>版本。与<a href="#%E5%AE%89%E8%A3%85JanusGraph">安装JanusGraph</a>的步骤非常类似。</p>
<h3 id="获取cassandra并解压">获取Cassandra并解压</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>cd /opt
</span></span><span style="display:flex;"><span>wget http://archive.apache.org/dist/cassandra/3.11.10/apache-cassandra-3.11.10-bin.tar.gz
</span></span><span style="display:flex;"><span>tar -xzvf apache-cassandra-3.11.10-bin.tar.gz
</span></span></code></pre></div><h3 id="为cassandra创建一个linux用户">为Cassandra创建一个Linux用户</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>adduser cassandra
</span></span></code></pre></div><p>在配置好新用户的相关信息后，配置其拥有的权限：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>chown -R cassandra:cassandra apache-cassandra-3.11.10
</span></span></code></pre></div><h2 id="安装elasticsearch">安装elasticsearch</h2>
<p>选择安装<code>elasticsearch7.14.0</code>版本。与<a href="#%E5%AE%89%E8%A3%85JanusGraph">安装JanusGraph</a>的步骤非常类似。</p>
<h3 id="获取elasticsearch并解压">获取elasticsearch并解压</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>cd /opt
</span></span><span style="display:flex;"><span>wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.14.0-linux-x86_64.tar.gz
</span></span><span style="display:flex;"><span>tar -xzvf elasticsearch-7.14.0-linux-x86_64.tar.gz
</span></span></code></pre></div><p>也可以通过<a href="https://www.elastic.co/downloads/elasticsearch">elasticsearch下载官网</a>选择合适的版本下载到本地，再上传至服务器进行解压。</p>
<h3 id="为elasticsearch创建一个linux用户">为elasticsearch创建一个Linux用户</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>adduser elasticsearch
</span></span></code></pre></div><p>在配置好新用户的相关信息后，配置其拥有的权限：</p>
<pre tabindex="0"><code>chown -R elasticsearch:elasticsearch elasticsearch-7.14.0
</code></pre><h2 id="配置本地wsl相关设置">配置本地wsl相关设置</h2>
<p><!-- raw HTML omitted --> <a href="#%E5%AE%89%E8%A3%85JanusGraph">安装JanusGraph</a>、<a href="#%E5%AE%89%E8%A3%85Cassandra">安装Cassandra</a>以及<a href="#%E5%AE%89%E8%A3%85elastcisearch">安装elastcisearch</a>需要在本地<code>wsl</code>以及云服务器上面全部完成安装。部署的时候若只启用<code>wsl</code>上的<code>Janus-server</code>，则在云服务器上只用安装<code>Cassandra</code>以及<code>elasticsearch</code>（若仅分布式部署<code>Cassandra</code>，在云服务器上只用安装<code>Cassandra</code>）。<!-- raw HTML omitted --></p>
<p>以下均以<!-- raw HTML omitted --><strong>仅分布式部署<code>Cassandra</code>为例</strong><!-- raw HTML omitted -->进行说明，若需要其他方案可以参考本文档进行部署。</p>
<p>分布式集群的架构图如下：</p>
<p><img src="https://Tsihan.github.io/images/posts/%E7%BD%91%E7%BB%9C%E5%9B%BE.png" alt="分布式集群架构图"></p>
<h3 id="配置wsl下的janusgraph">配置wsl下的JanusGraph</h3>
<p>需要配置的文件有 <code>janusgraph-0.6.2/conf/gremlin-server/gremlin-server-cql-es.yaml</code>、<code>janusgraph-0.6.2/conf/janusgraph-cql-es.properties</code>以及<code>janusgraph-0.6.2/conf/remote.yaml</code>。</p>
<h4 id="配置gremlin-server-cql-esyaml文件">配置gremlin-server-cql-es.yaml文件</h4>
<p>对于此次部署，该文件暂时不用做任何修改。</p>
<h4 id="配置janusgraph-cql-esproperties文件">配置janusgraph-cql-es.properties文件</h4>
<p>主要对于默认配置进行如下几个修改：</p>
<pre tabindex="0"><code>storage.hostname=xx.xx.xx.xx,xx.xx.xx.xx,xx.xx.xx.xx,xx.xx.xx.xx
index.search.hostname=127.0.0.1
</code></pre><p><code>storage.hostname</code>配置为4台云服务器的公网IP地址。由于本次部署<code>elasticsearch</code>全局索引仅部署在本地<code>wsl</code>，故<code>index.search.hostname</code>配置为本地环回地址。</p>
<h4 id="配置remoteyaml文件">配置remote.yaml文件</h4>
<p>对于此次部署，由于<code>Janus-server</code>部署在本地<code>wsl</code>，故<code>hosts</code>不用做任何修改：</p>
<pre tabindex="0"><code>hosts: [localhost]
</code></pre><h3 id="配置wsl下的elasticsearch">配置wsl下的elasticsearch</h3>
<p>由于本次部署<code>elasticsearch</code>全局索引仅部署在本地<code>wsl</code>，暂时不用对<code>elasticsearch</code>下的配置文件做任何修改。且本次部署旨在优化基于边和1跳邻居的查询，而<code>elasticsearch</code>为<code>JanusGraph</code>提供的<code>MixedIndex</code>主要用于<code>geo</code>, <code>numeric range</code>, 以及<code>full-text search</code>的底层索引支持，与本次内核开发的目的无关。</p>
<h3 id="配置wsl下的cassandra">配置wsl下的Cassandra</h3>
<p>需要配置的文件有<code>apache-cassandra-3.11.10/conf/cassandra.yaml</code>。<!-- raw HTML omitted --><strong>本次部署仅使用了远程云服务器<code>Cassandra</code>存储。目的在于尽最大程度工程化分布式图摘要算法。</strong><!-- raw HTML omitted -->&gt;</p>
<p>主要修改相应的IP地址以及种子节点：</p>
<pre tabindex="0"><code>seed_provider:
    # Addresses of hosts that are deemed contact points. 
    # Cassandra nodes use this list of hosts to find each other and learn
    # the topology of the ring.  You must change this if you are running
    # multiple nodes!
    - class_name: org.apache.cassandra.locator.SimpleSeedProvider
      parameters:
          # seeds is actually a comma-delimited list of addresses.
          # Ex: &#34;&lt;ip1&gt;,&lt;ip2&gt;,&lt;ip3&gt;&#34;
          - seeds: &#34;xx.xx.xx.xx&#34;
</code></pre><p>这里的种子节点<code>seeds</code>配置为四台云服务器一台（配置最高、运行最稳定）中的公网IP。</p>
<p>监听地址不变：</p>
<pre tabindex="0"><code>listen_address: localhost
</code></pre><p>打开rpc:</p>
<pre tabindex="0"><code>start_rpc: true
</code></pre><p>设置rpc地址：</p>
<pre tabindex="0"><code>rpc_address: localhost
</code></pre><h2 id="配置云服务器相关设置">配置云服务器相关设置</h2>
<p>由于仅部署<code>Cassandra</code>，仅需修改<code>apache-cassandra-3.11.10/conf/cassandra.yaml</code>文件下的相关配置：</p>
<pre tabindex="0"><code>seed_provider:
    # Addresses of hosts that are deemed contact points. 
    # Cassandra nodes use this list of hosts to find each other and learn
    # the topology of the ring.  You must change this if you are running
    # multiple nodes!
    - class_name: org.apache.cassandra.locator.SimpleSeedProvider
      parameters:
          # seeds is actually a comma-delimited list of addresses.
          # Ex: &#34;&lt;ip1&gt;,&lt;ip2&gt;,&lt;ip3&gt;&#34;
          - seeds: &#34;172.25.16.4&#34;
</code></pre><p>这里的种子节点<code>seeds</code>配置为四台云服务器一台（配置最高、运行最稳定）中的私网IP。</p>
<pre tabindex="0"><code>listen_address: 172.25.16.3
</code></pre><p><code>listen_address</code>配置为当前云服务器私网IP。</p>
<pre tabindex="0"><code>rpc_address: 0.0.0.0
</code></pre><p><code>rpc_address</code>配置为0.0.0.0。</p>
<pre tabindex="0"><code>broadcast_address: 172.25.16.3
</code></pre><p><code>broadcast_address</code>配置为当前云服务器私网IP。</p>
<p>打开<code>rpc</code>:</p>
<pre tabindex="0"><code>start_rpc: true
</code></pre><p>设置<code>广播rpc</code>地址：</p>
<pre tabindex="0"><code>broadcast_rpc_address: xx.xx.xx.xx
</code></pre><p><code>broadcast_rpc_address</code>配置为当前云服务器公网IP。</p>
<p><!-- raw HTML omitted --><strong>更多复杂的配置还会涉及到数据中心、机架等设置与分区，本次部署为单一中心，故不需要对Cassandra默认配置进行修改。</strong><!-- raw HTML omitted --></p>
<h2 id="启动集群步骤">启动集群步骤</h2>
<p>首先在本地<code>wsl</code>开启两个终端，分别输入如下指令切换到指定的用户：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#以下操作的目录均在/opt下</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#终端一</span>
</span></span><span style="display:flex;"><span>su elasticsearch
</span></span><span style="display:flex;"><span><span style="color:#75715e">#终端二</span>
</span></span><span style="display:flex;"><span>su janus
</span></span></code></pre></div><p>启动云端服务器种子节点的<code>Cassandra</code>服务，命令如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#切换用户</span>
</span></span><span style="display:flex;"><span>su cassandra
</span></span><span style="display:flex;"><span><span style="color:#75715e">#进入指定目录下</span>
</span></span><span style="display:flex;"><span>cd /opt
</span></span><span style="display:flex;"><span><span style="color:#75715e">#在前台运行Cassandra</span>
</span></span><span style="display:flex;"><span>apache-cassandra-3.11.10/bin/cassandra -f
</span></span></code></pre></div><p><img src="https://Tsihan.github.io/images/posts/1%E5%90%AF%E5%8A%A8Cassandra%E7%A7%8D%E5%AD%90%E8%8A%82%E7%82%B9.png" alt="启动Cassandra种子节点"></p>
<p>启动其他三台非种子节点的云服务器，输入如下命令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#切换用户</span>
</span></span><span style="display:flex;"><span>su cassandra
</span></span><span style="display:flex;"><span><span style="color:#75715e">#进入指定目录下</span>
</span></span><span style="display:flex;"><span>cd /opt
</span></span><span style="display:flex;"><span><span style="color:#75715e">#在前台运行Cassandra</span>
</span></span><span style="display:flex;"><span>apache-cassandra-3.11.10/bin/cassandra -f
</span></span></code></pre></div><p><img src="https://Tsihan.github.io/images/posts/2%E5%90%AF%E5%8A%A8%E9%9D%9E%E7%A7%8D%E5%AD%90%E8%8A%82%E7%82%B9Cassandra.png" alt="启动Cassandra非种子节点"></p>
<p>种子节点会显示非种子节点的相关信息：</p>
<p>![种子节点显示非种子节点相关信息图](<a href="https://Tsihan.github.io/images/posts/3">https://Tsihan.github.io/images/posts/3</a> 种子节点反应.png)</p>
<p>此时集群中各有一个种子节点和非种子节点：</p>
<p><img src="https://Tsihan.github.io/images/posts/4%E7%A7%8D%E5%AD%90%E8%8A%82%E7%82%B9%E5%8F%8D%E5%BA%942.png" alt="种子节点显示非种子节点相关信息图"></p>
<p>其余节点启动类似，当三台种子节点均完成启动并加入集群之后种子节点应该有如下终端显示：</p>
<p><img src="https://Tsihan.github.io/images/posts/5%E5%90%AF%E5%8A%A8%E7%AC%AC%E4%B8%89%E5%8F%B0%E6%9C%BA%E5%99%A8.png" alt="集群建立图"></p>
<p>通过<code>gossip</code>共识协议完成信息交互，<code>Cassandra</code>集群成功启动之后，在本地<code>wsl</code>终端输入如下命令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#终端一</span>
</span></span><span style="display:flex;"><span>elasticsearch-7.14.0/bin/elasticsearch
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#终端二 启动Janus-Server在前台显示</span>
</span></span><span style="display:flex;"><span>janusgraph-0.6.2/bin/janusgraph-server.sh janusgraph-0.6.2/conf/gremlin-server/gremlin-server-cql-es.yaml console
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#新建一个终端三，用于开启Gremlin-Client。注意第三个终端也在/opt目录下</span>
</span></span><span style="display:flex;"><span>su janus
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>janusgraph-0.6.2/bin/gremlin.sh 
</span></span></code></pre></div><p>启动本地<code>wsl</code>的<code>elasticsearch</code>终端显示如下：</p>
<p><img src="https://Tsihan.github.io/images/posts/9%E5%90%AF%E5%8A%A8elasticsearch.png" alt="启动本地elasticsearch图"></p>
<p>启动本地<code>wsl</code>的<code>Janus-Server</code>终端显示如下：</p>
<p>![启动本地Janus-Server图](<a href="https://Tsihan.github.io/images/posts/10">https://Tsihan.github.io/images/posts/10</a> 启动janussever成功运行.png)</p>
<p>启动本地<code>wsl</code>的<code>Gremlin-Client</code>终端显示如下：</p>
<p><img src="https://Tsihan.github.io/images/posts/11%E5%90%AF%E5%8A%A8gremlinserver.png" alt="启动本地Gremlin-Server图"></p>
<p>在本地<code>wsl</code>的<code>Gremlin-Client</code>终端下输入如下命令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#使gremlin-Client与在本地的janus-Sever建立连接</span>
</span></span><span style="display:flex;"><span>gremlin&gt; :remote connect tinkerpop.server conf/remote.yaml
</span></span><span style="display:flex;"><span><span style="color:#f92672">==</span>&gt;Configured localhost/127.0.0.1:8182
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#将以下所有命令发送到远端janus-Sever（本次集群部署远端janus-Sever就在本地wsl），使得无需使用标记“:&gt;”进行命令转发</span>
</span></span><span style="display:flex;"><span>gremlin&gt; :remote console
</span></span><span style="display:flex;"><span><span style="color:#f92672">==</span>&gt;All scripts will now be sent to Gremlin Server - <span style="color:#f92672">[</span>localhost/127.0.0.1:8182<span style="color:#f92672">]</span> - type <span style="color:#e6db74">&#39;:remote console&#39;</span> to <span style="color:#66d9ef">return</span> to local mode
</span></span><span style="display:flex;"><span><span style="color:#75715e">#查看后端存储配置，说明成功启动集群</span>
</span></span><span style="display:flex;"><span>gremlin&gt; graph
</span></span><span style="display:flex;"><span><span style="color:#f92672">==</span>&gt;standardjanusgraph<span style="color:#f92672">[</span>cql:<span style="color:#f92672">[</span>47.108.220.140, 47.108.80.65, 47.108.30.249, 47.108.175.71<span style="color:#f92672">]]</span>
</span></span></code></pre></div><p>由于<code>Cassandra</code>后端是永久存储，故退出<code>Gremlin-Client</code>后内容会得到保存。具体可以通过<code>Cassandra</code>提供的<code>cqlsh</code>工具进行数据的解析。</p>
<h2 id="关闭集群步骤">关闭集群步骤</h2>
<p>首先关闭<code>Gremlin-Client</code>，具体命令如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>gremlin&gt; :exit
</span></span></code></pre></div><p>关闭本地wsl的<code>janus-Sever</code>，在终端键入<code>^c</code>：</p>
<p><img src="https://Tsihan.github.io/images/posts/12%E5%85%B3%E9%97%ADjanus-sever.png" alt="关闭本地Janus-Server图"></p>
<p>关闭本地wsl的<code>elasticsearch</code>，在终端键入<code>^c</code>：</p>
<p><img src="https://Tsihan.github.io/images/posts/13%E5%85%B3%E9%97%ADelasticsearch.png" alt="关闭本地elasticsearch图"></p>
<p>关闭非种子节点云服务器的<code>Cassandra</code>，在终端键入<code>^c</code>：</p>
<p><img src="https://Tsihan.github.io/images/posts/14%E5%85%B3%E9%97%AD%E9%9D%9E%E7%A7%8D%E5%AD%90%E8%8A%82%E7%82%B9Cassandra.png" alt="关闭非种子节点云服务器的Cassandra图"></p>
<p>此时种子节点以及其他节点会有如下反应：</p>
<p><img src="https://Tsihan.github.io/images/posts/15%E7%A7%8D%E5%AD%90%E8%8A%82%E7%82%B9%E5%8F%8D%E5%BA%94.png" alt="节点反应图"></p>
<p>非种子节点均关闭后，种子节点的终端会有如下显示：</p>
<pre tabindex="0"><code>INFO  [GossipStage:1] 2023-03-07 19:20:12,729 Gossiper.java:1120 - InetAddress /172.25.16.1 is now DOWN
INFO  [HANDSHAKE-/172.25.16.1] 2023-03-07 19:20:13,670 OutboundTcpConnection.java:561 - Handshaking version with /172.25.16.1
INFO  [GossipStage:1] 2023-03-07 19:21:54,248 Gossiper.java:1120 - InetAddress /172.25.16.2 is now DOWN
INFO  [HANDSHAKE-/172.25.16.2] 2023-03-07 19:21:54,538 OutboundTcpConnection.java:561 - Handshaking version with /172.25.16.2
INFO  [GossipStage:1] 2023-03-07 19:22:13,482 Gossiper.java:1120 - InetAddress /172.25.16.3 is now DOWN
INFO  [HANDSHAKE-/172.25.16.3] 2023-03-07 19:22:13,544 OutboundTcpConnection.java:561 - Handshaking version with /172.25.16.3
</code></pre><p>关闭种子节点，最终终端显示如下：</p>
<p><img src="https://Tsihan.github.io/images/posts/16%E5%85%B3%E9%97%AD%E7%A7%8D%E5%AD%90%E8%8A%82%E7%82%B9.png" alt="最终终端图"></p>
<p><!-- raw HTML omitted --><strong>至此JanusGraph0.6.2分布式集群部署文档全部结束。</strong><!-- raw HTML omitted --></p>

              


            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">标签</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://Tsihan.github.io/tags/tag1/">tag1</a>

  <a class="tag tag--primary tag--small" href="https://Tsihan.github.io/tags/tag2/">tag2</a>

                  </div>
                
              
            
            
<div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://Tsihan.github.io/post/graduation-4-post/" data-tooltip="构建本地的python客户端以及导入自带gremlin json格式数据文档" aria-label="下一篇: 构建本地的python客户端以及导入自带gremlin json格式数据文档">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">下一篇</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://Tsihan.github.io/post/graduation-2-post/" data-tooltip="JanusGraph0.6.2源代码编译（生成可发布版本）" aria-label="上一篇: JanusGraph0.6.2源代码编译（生成可发布版本）">
          
              <span class="hide-xs hide-sm text-small icon-mr">上一篇</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
<ul class="post-actions post-action-share" >
  
    <li class="post-action hide-lg hide-md hide-sm">
      <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="分享这个帖子">
        <i class="fa fa-share-alt" aria-hidden="true"></i>
      </a>
    </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://Tsihan.github.io/post/graduation-3-post/" title="分享到 Facebook" aria-label="分享到 Facebook">
          <i class="fab fa-facebook-square" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://Tsihan.github.io/post/graduation-3-post/" title="分享到 Twitter" aria-label="分享到 Twitter">
          <i class="fab fa-twitter" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/sharing/share-offsite/?url=https://Tsihan.github.io/post/graduation-3-post/" title="分享到 Linkedin" aria-label="分享到 Linkedin">
          <i class="fab fa-linkedin" aria-hidden="true"></i>
        </a>
      </li>
    
  
  
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#disqus_thread" aria-label="发表评论">
        <i class="far fa-comment"></i>
      </a>
    </li>
  
  <li class="post-action">
    
      <a class="post-action-btn btn btn--default" href="#top" aria-label="回到顶部">
      <i class="fa fa-arrow-up" aria-hidden="true"></i>
    
    </a>
  </li>
</ul>
</div>


            
  
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
    <script type="text/javascript">
      var disqus_config = function() {
        this.page.url = 'https:\/\/Tsihan.github.io\/post\/graduation-3-post\/';
        
          this.page.identifier = '\/post\/graduation-3-post\/'
        
      };
      (function() {
        
        
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
          document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
          return;
        }
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        var disqus_shortname = 'hugo-tranquilpeak-theme';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
  


          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2023 Qihan Zhang. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        
<div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://Tsihan.github.io/post/graduation-4-post/" data-tooltip="构建本地的python客户端以及导入自带gremlin json格式数据文档" aria-label="下一篇: 构建本地的python客户端以及导入自带gremlin json格式数据文档">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">下一篇</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://Tsihan.github.io/post/graduation-2-post/" data-tooltip="JanusGraph0.6.2源代码编译（生成可发布版本）" aria-label="上一篇: JanusGraph0.6.2源代码编译（生成可发布版本）">
          
              <span class="hide-xs hide-sm text-small icon-mr">上一篇</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
<ul class="post-actions post-action-share" >
  
    <li class="post-action hide-lg hide-md hide-sm">
      <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="分享这个帖子">
        <i class="fa fa-share-alt" aria-hidden="true"></i>
      </a>
    </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://Tsihan.github.io/post/graduation-3-post/" title="分享到 Facebook" aria-label="分享到 Facebook">
          <i class="fab fa-facebook-square" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://Tsihan.github.io/post/graduation-3-post/" title="分享到 Twitter" aria-label="分享到 Twitter">
          <i class="fab fa-twitter" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/sharing/share-offsite/?url=https://Tsihan.github.io/post/graduation-3-post/" title="分享到 Linkedin" aria-label="分享到 Linkedin">
          <i class="fab fa-linkedin" aria-hidden="true"></i>
        </a>
      </li>
    
  
  
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#disqus_thread" aria-label="发表评论">
        <i class="far fa-comment"></i>
      </a>
    </li>
  
  <li class="post-action">
    
      <a class="post-action-btn btn btn--default" href="#top" aria-label="回到顶部">
      <i class="fa fa-arrow-up" aria-hidden="true"></i>
    
    </a>
  </li>
</ul>
</div>


      </div>
      
<div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-times"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2FTsihan.github.io%2Fpost%2Fgraduation-3-post%2F" aria-label="分享到 Facebook">
          <i class="fab fa-facebook-square" aria-hidden="true"></i><span>分享到 Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https%3A%2F%2FTsihan.github.io%2Fpost%2Fgraduation-3-post%2F" aria-label="分享到 Twitter">
          <i class="fab fa-twitter" aria-hidden="true"></i><span>分享到 Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2FTsihan.github.io%2Fpost%2Fgraduation-3-post%2F" aria-label="分享到 Linkedin">
          <i class="fab fa-linkedin" aria-hidden="true"></i><span>分享到 Linkedin</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>


    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-times"></i>
    </div>
    
      <img id="about-card-picture" src="https://Tsihan.github.io/images/icon.jpg" alt="作者的图片" />
    
    <h4 id="about-card-name">Qihan Zhang</h4>
    
      <div id="about-card-bio">male</div>
    
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker-alt"></i>
        <br/>
        美国加州洛杉矶
      </div>
    
  </div>
</div>

    

    
  
    
      <div id="cover" style="background-image:url('https://Tsihan.github.io/images/cover.jpg');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/highlight.min.js" integrity="sha512-z+/WWfyD5tccCukM4VvONpEtLmbAm5LDu7eKiyMQJ9m7OfPEDL7gENyDRL3Yfe8XAuGsS2fS4xSMnl6d30kqGQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


<script src="https://Tsihan.github.io/js/script-yqzy9wdlzix4lbbwdnzvwx3egsne77earqmn73v9uno8aupuph8wfguccut.min.js"></script>


  
    <script async crossorigin="anonymous" defer integrity="sha512-gE8KAQyFIzV1C9+GZ8TKJHZS2s+n7EjNtC+IMRn1l5+WYJTHOODUM6JSjZhFhqXmc7bG8Av6XXpckA4tYhflnw==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/apache.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-EWROca+bote+7Oaaar1F6y74iZj1r1F9rm/ly7o+/FwJopbBaWtsFDmaKoZDd3QiGU2pGacBirHJNivmGLYrow==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/go.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-GDVzAn0wpx1yVtQsRWmFc6PhJiLBPdUic+h4GWgljBh904O3JU10fk9EKNpVyIoPqkFn54rgL2QBG4BmUTMpiQ==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/http.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-UgZlma8NzkrDb/NWgmLIcTrH7i/CSnLLDRFqCSNF5NGPpjKmzyM25qcoXGOup8+cDakKyaiTDd7N4dyH4YT+IA==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/less.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-lot9koe73sfXIrUvIPM/UEhuMciN56RPyBdOyZgfO53P2lkWyyXN7J+njcxIIBRV+nVDQeiWtiXg+bLAJZDTfg==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/nginx.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-Zd3e7XxHP00TD0Imr0PIfeM0fl0v95kMWuhyAS3Wn1UTSXTkz0OhtRgBAr4JlmADRgiXr4x7lpeUdqaGN8xIog==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/puppet.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-qtqDO052iXMSP+5d/aE/jMtL9vIIGvONgTJziC2K/ZIB1yEGa55WVxGE9/08rSQ62EoDifS9SWVGZ7ihSLhzMA==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/scss.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-1NmkjnEDnwwwcu28KoQF8vs3oaPFokQHbmbtwGhFfeDsQZtVFI8zW2aE9O8yMYdpdyKV/5blE4pSWw4Z/Sv97w==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/stylus.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-B2wSfruPjr8EJL6IIzQr1eAuDwrsfIfccNf/LCEdxELCgC/S/ZMt/Uvk80aD79m7IqOqW+Sw8nbkvha20yZpzg==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/swift.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-28oDiQZGKUVN6wQ7PSLPNipOcmkCALXKwOi7bnkyFf8QiMZQxG9EQoy/iiNx6Zxj2cG2SbVa4dXKigQhu7GiFw==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/yaml.min.js"></script>
  


<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>




    
  </body>
</html>

